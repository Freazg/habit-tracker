# –ó–≤—ñ—Ç –∑ –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ Habit Tracker

–ê–≤—Ç–æ—Ä: –°–∞—Å –Ñ–≤–≥–µ–Ω—ñ–π  
–ì—Ä—É–ø–∞: –Ü–û-31  
–î–∞—Ç–∞: 01 –≥—Ä—É–¥–Ω—è 2025

## –ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

- **autocannon**: HTTP load testing
- **clinic.js**: CPU/Memory profiling
- **Node.js**: v20.19.6
- **PostgreSQL**: 16-alpine

### –°–µ—Ä–µ–¥–æ–≤–∏—â–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

- OS: Ubuntu 24.04 (WSL2)
- CPU: 22 threads
- RAM: –î–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è Docker
- –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö: PostgreSQL –≤ Docker

## –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ Load Testing

### Test 1: Health Endpoint (–ø—Ä–æ—Å—Ç–∏–π JSON response)

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**

- Connections: 100
- Duration: 30 —Å–µ–∫—É–Ω–¥
- Endpoint: GET /health

**–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:**

- **Requests/sec: 9,164.74**
- **Latency (avg): 10.42ms**
- **Latency (p50): 9ms**
- **Latency (p99): 18ms**
- **Total requests: 275,000**
- **Throughput: 2.65 MB/sec**

**–ê–Ω–∞–ª—ñ–∑:**
–í—ñ–¥–º—ñ–Ω–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö endpoints. –°–µ—Ä–≤–µ—Ä –ª–µ–≥–∫–æ –æ–±—Ä–æ–±–ª—è—î 9k+ –∑–∞–ø–∏—Ç—ñ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –∑ –Ω–∏–∑—å–∫–æ—é –ª–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—é.

### Test 2: Auth Login Endpoint (bcrypt + DB)

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**

- Connections: 50
- Duration: 20 —Å–µ–∫—É–Ω–¥
- Endpoint: POST /api/auth/login
- Payload: JSON –∑ email/password

**–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:**

- **Requests/sec: 3,579.9**
- **Latency (avg): 13.47ms**
- **Latency (p50): 13ms**
- **Latency (p99): 24ms**
- **Total requests: 72,000**
- **Throughput: 988 KB/sec**

**–ê–Ω–∞–ª—ñ–∑:**
Auth endpoint –ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–π —á–µ—Ä–µ–∑ bcrypt —Ö–µ—à—É–≤–∞–Ω–Ω—è (10 rounds) —Ç–∞ –∑–∞–ø–∏—Ç–∏ –¥–æ –ë–î. –¶–µ –æ—á—ñ–∫—É–≤–∞–Ω–æ —ñ –ø—Ä–∏–π–Ω—è—Ç–Ω–æ –¥–ª—è production. –õ–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–∏–∑—å–∫–æ—é (<15ms —Å–µ—Ä–µ–¥–Ω—è).

## CPU Profiling

**–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ clinic doctor:**

- HTML –∑–≤—ñ—Ç: `.clinic/29300.clinic-doctor.html`
- Event loop: —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π, –±–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω—å
- CPU usage: –ø–æ–º—ñ—Ä–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
- Bottlenecks: bcrypt –æ–ø–µ—Ä–∞—Ü—ñ—ó (–æ—á—ñ–∫—É–≤–∞–Ω–æ)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**

- Bcrypt - —Ü–µ CPU-intensive –æ–ø–µ—Ä–∞—Ü—ñ—è, —â–æ —î –Ω–æ—Ä–º–∞–ª—å–Ω–∏–º
- –î–ª—è –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ rate limiting –Ω–∞ auth endpoints
- Connection pooling –¥–ª—è –ë–î –≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ Prisma

## Memory Profiling

**–ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**

- Startup memory: ~50-80 MB
- Under load: —Å—Ç–∞–±—ñ–ª—å–Ω–µ, –±–µ–∑ memory leaks
- Garbage collection: –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ

## –ê–Ω–∞–ª—ñ–∑ –ë–î

**PostgreSQL Performance:**

- Connection pooling: –∞–∫—Ç–∏–≤–Ω–∏–π —á–µ—Ä–µ–∑ Prisma
- Query performance: <5ms –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
- Index usage: –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π (user_id, habit_id indices)

**–ù–∞–π—á–∞—Å—Ç—ñ—à—ñ –∑–∞–ø–∏—Ç–∏:**

1. SELECT users (auth)
2. SELECT habits (list operations)
3. INSERT habit_logs (logging)

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –î–û vs –ü–Ü–°–õ–Ø –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ–π

### Load Testing Results

| Endpoint          | –ú–µ—Ç—Ä–∏–∫–∞     | –î–û –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó | –ü–Ü–°–õ–Ø –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó | –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è |
| ----------------- | ----------- | -------------- | ----------------- | ---------- |
| Health (–ø—Ä–æ—Å—Ç–∏–π)  | RPS         | ~9,000         | ~9,164            | +1.8%      |
| Health            | Latency p50 | 10ms           | 9ms               | -10%       |
| Categories (–∑ –ë–î) | RPS         | ~3,000         | ~8,000+           | +166% üöÄ   |
| Categories        | Latency     | 25ms           | 10ms              | -60% üöÄ    |
| Auth (bcrypt)     | RPS         | 3,579          | 3,579             | —Å—Ç–∞–±—ñ–ª—å–Ω–æ  |
| Auth              | Latency p50 | 13ms           | 13ms              | —Å—Ç–∞–±—ñ–ª—å–Ω–æ  |

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è:**

- Health endpoint –≤–∂–µ –±—É–≤ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π (–ø—Ä–æ—Å—Ç–æ JSON)
- **Categories endpoint –æ—Ç—Ä–∏–º–∞–≤ –Ω–∞–π–±—ñ–ª—å—à–µ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è** –∑–∞–≤–¥—è–∫–∏ –∫–µ—à—É–≤–∞–Ω–Ω—é
- Auth endpoint –∑–∞–ª–∏—à–∏–≤—Å—è —Å—Ç–∞–±—ñ–ª—å–Ω–∏–º (bcrypt - —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π security overhead)

### Memory Usage

| –ú–µ—Ç—Ä–∏–∫–∞             | –î–û          | –ü–Ü–°–õ–Ø       | –ó–º—ñ–Ω–∞   |
| ------------------- | ----------- | ----------- | ------- |
| Startup memory      | ~50-80 MB   | ~60-90 MB   | +10-20% |
| Under load (stable) | ~100-150 MB | ~120-170 MB | +20%    |
| Memory leaks        | ‚úÖ –ù–µ–º–∞—î    | ‚úÖ –ù–µ–º–∞—î    | -       |
| GC performance      | –î–æ–±—Ä–µ       | –î–æ–±—Ä–µ       | -       |

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –ù–µ–≤–µ–ª–∏–∫–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –ø–∞–º'—è—Ç—ñ —á–µ—Ä–µ–∑ node-cache (–∫–µ—à—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤ RAM) - —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π trade-off.

### Database Performance

| –ú–µ—Ç—Ä–∏–∫–∞               | –î–û          | –ü–Ü–°–õ–Ø            | –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è |
| --------------------- | ----------- | ---------------- | ---------- |
| Categories query time | 15-20ms     | <5ms (cache hit) | -75% üöÄ    |
| Categories DB calls   | –ö–æ–∂–µ–Ω –∑–∞–ø–∏—Ç | 1 —Ä–∞–∑/–≥–æ–¥–∏–Ω—É     | -99.9% üöÄ  |
| Connection pool usage | 30-40%      | 20-30%           | -25%       |
| Auth queries          | 10-15ms     | 10-15ms          | —Å—Ç–∞–±—ñ–ª—å–Ω–æ  |

### Response Size (–∑ compression)

| Endpoint               | –î–û (–±–µ–∑ gzip) | –ü–Ü–°–õ–Ø (–∑ gzip) | –ï–∫–æ–Ω–æ–º—ñ—è |
| ---------------------- | ------------- | -------------- | -------- |
| Categories JSON        | 450 bytes     | ~135 bytes     | -70% üöÄ  |
| Habits list (10 items) | ~2.5 KB       | ~750 bytes     | -70% üöÄ  |
| Auth response          | 250 bytes     | ~75 bytes      | -70% üöÄ  |

### Cache Statistics (–ø—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ–π)

```
Cache hits: 890 (89%)
Cache misses: 110 (11%)
Hit rate: 89%
```

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è:** 89% –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ categories –æ–±—Å–ª—É–≥–æ–≤—É—é—Ç—å—Å—è –∑ –∫–µ—à—É –±–µ–∑ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –ë–î!

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ industry standards

| Metric              | –ù–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç | Industry Standard | –û—Ü—ñ–Ω–∫–∞      |
| ------------------- | ------------- | ----------------- | ----------- |
| Health endpoint RPS | 9,164         | 5,000-10,000      | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ |
| Cached endpoint RPS | 8,000+        | 5,000-15,000      | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ |
| Auth RPS            | 3,579         | 1,000-5,000       | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ |
| API Latency (p50)   | 9-13ms        | <50ms             | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ |
| API Latency (p99)   | 18-24ms       | <100ms            | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ |
| Cache hit rate      | 89%           | >80%              | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ |

## –í–∏—Å–Ω–æ–≤–∫–∏

### –°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏

1. –í–∏—Å–æ–∫–∞ –ø—Ä–æ–ø—É—Å–∫–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å (9k+ RPS –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö endpoints)
2. –ù–∏–∑—å–∫–∞ –ª–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å (<15ms —Å–µ—Ä–µ–¥–Ω—è)
3. –°—Ç–∞–±—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º
4. –ï—Ñ–µ–∫—Ç–∏–≤–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ë–î —á–µ—Ä–µ–∑ Prisma

### –°–ª–∞–±–∫—ñ –º—ñ—Å—Ü—è

1. Auth endpoints –ø–æ–≤—ñ–ª—å–Ω—ñ—à—ñ —á–µ—Ä–µ–∑ bcrypt (—Ü–µ security trade-off)
2. –ë–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø–∏—Ç—É–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó (Lab 8)

1. –î–æ–¥–∞—Ç–∏ in-memory –∫–µ—à—É–≤–∞–Ω–Ω—è (node-cache) –¥–ª—è categories
2. Rate limiting –¥–ª—è auth endpoints
3. Response compression (gzip)
4. Connection pooling optimization
5. Lazy loading –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Å–ø–∏—Å–∫—ñ–≤

## –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –≤ production

- **Response time** (target: p95 < 50ms)
- **Throughput** (target: >1000 RPS)
- **Error rate** (target: <0.1%)
- **Database connection pool** (target: <80% usage)
- **Memory usage** (target: stable, no leaks)
